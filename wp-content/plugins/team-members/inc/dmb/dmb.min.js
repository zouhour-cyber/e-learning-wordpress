/**
 * Team Members Admin JS (minified)
 */

!function(e){e(document).ready(function(){var t;t=jQuery.fn.clone,jQuery.fn.clone=function(){for(var i=t.apply(this,arguments),m=this.find("textarea").add(this.filter("textarea")),n=i.find("textarea").add(i.filter("textarea")),_=this.find("select").add(this.filter("select")),s=i.find("select").add(i.filter("select")),a=0,l=m.length;a<l;++a)e(n[a]).val(e(m[a]).val());for(a=0,l=_.length;a<l;++a)s[a].selectedIndex=_[a].selectedIndex;return i};var i,m,n,_,s=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");function a(e){return isNaN(e)?"00":s[(e-e%16)/16]+s[e%16]}function l(t){var i=t.closest(".dmb_main"),m=i.find(".dmb_firstname_of_member").val()||"",n=i.find(".dmb_lastname_of_member").val()||"",_=i.find(".dmb_job_of_member").val()||"";e("#acf-fallback-bio").length?description=e.trim(i.find(".dmb_description_of_member_fb").text())||"":description=e.trim(i.find(".dmb_description_of_member").html())||"";var s=i.find(".dmb_scl_type1_of_member").val()||"",a=i.find(".dmb_scl_title1_of_member").val()||"",l=i.find(".dmb_scl_url1_of_member").val()||"",d=i.find(".dmb_scl_type2_of_member").val()||"",o=i.find(".dmb_scl_title2_of_member").val()||"",r=i.find(".dmb_scl_url2_of_member").val()||"",c=i.find(".dmb_scl_type3_of_member").val()||"",b=i.find(".dmb_scl_title3_of_member").val()||"",f=i.find(".dmb_scl_url3_of_member").val()||"",h=i.find(".dmb_img_data_url").attr("data-img")||"",p=i.find(".dmb_photo_url_of_member").val()||"";i.find(".dmb_data_dump").val(m+"]--["+n+"]--["+_+"]--["+description+"]--["+s+"]--["+a+"]--["+l+"]--["+d+"]--["+o+"]--["+r+"]--["+c+"]--["+b+"]--["+f+"]--["+h+"]--["+p)}function d(){e(".dmb_main").not(".dmb_empty_row").length>0?e(".dmb_no_row_notice").hide():e(".dmb_no_row_notice").show()}function o(e,t){t||(t=!1);var i=(e=e).closest(".dmb_main").find(".dmb_lastname_of_member").val()||"";handleTitle=e.closest(".dmb_main").find(".dmb_handle_title"),cloneCopyText="",cloneCopyText=t?" copy":"",""!=e.val()?handleTitle.html(e.val()+" "+i+cloneCopyText):handleTitle.html(objectL10n.untitled+cloneCopyText)}if(e(".dmb_color_picker").each(function(t,i){e(this).wpColorPicker()}),e("body").on("keyup",".dmb_field",function(t){l(e(this))}),e("body").on("change",".dmb_scl_type_select",function(t){l(e(this))}),e("body").on("change",".dmb_img_data_url",function(t){l(e(this))}),e(".dmb_img_data_url").each(function(t,i){var m=e(this).attr("data-img");""!=m&&e("<a class='dmb_remove_img_btn dmb_button dmb_button_large dmb_button_compact' href='#'><span class='dashicons dashicons-trash'></span></a><img src='"+m+"' class='dmb_img'/>").insertAfter(e(this).parent().find(".dmb_upload_img_btn"))}),e(".dmb_main").not(".dmb_empty_row").each(function(t,i){e(this).find(".dmb_description_of_member").each(function(t,i){""==e.trim(e(this).text())?e(this).hide():e(this).show(),e(this).html(e.parseHTML(e(this).text()))}),l(e(this).find(".dmb_field").first())}),d(),e("body").on("click",".dmb_remove_img_btn",function(t){return e(this).parent().find(".dmb_img").remove(),e(this).parent().find(".dmb_img_data_url").attr("data-img","").trigger("change"),e(this).remove(),!1}),e(".dmb_upload_img_btn").click(function(t){t.preventDefault();var i=e(this),m=wp.media({title:"Insert image",library:{type:"image"},button:{text:"Use this image"},multiple:!1}).on("select",function(){var t=m.state().get("selection").first().toJSON();i.siblings("img, .dmb_remove_img_btn, .dashicons-trash").remove(),e("<a class='dmb_remove_img_btn dmb_button dmb_button_large dmb_button_compact' href='#'><span class='dashicons dashicons-trash'></span></a><img src='"+t.url+"' class='dmb_img'/>").insertAfter(i),i.siblings(".dmb_img_data_url").attr("data-img",t.url).trigger("change")}).open()}),e(".dmb_add_row").on("click",function(){var t=e(".dmb_empty_row").clone(!0);return t.removeClass("dmb_empty_row").addClass("dmb_main").show(),t.insertBefore(e(".dmb_empty_row")),t.find(".dmb_firstname_of_member").focus(),t.find(".dmb_color_picker_ready").removeClass(".dmb_color_picker_ready").addClass(".dmb_color_picker").wpColorPicker().css({padding:"3px"}),t.find(".dmb_handle_title").html(objectL10n.untitled),t.find(".dmb_description_of_member").hide(),d(),!1}),e(".dmb_remove_row_btn").click(function(t){return e(this).closest(".dmb_main").remove(),d(),!1}),e(".dmb_handle").click(function(t){return e(this).siblings(".dmb_inner").slideToggle(50),e(this).hasClass("closed")?e(this).removeClass("closed"):e(this).addClass("closed"),!1}),e(".dmb_collapse_rows").click(function(t){return e(".dmb_handle").each(function(t,i){e(this).closest(".dmb_empty_row").length||e(this).hasClass("closed")||(e(this).siblings(".dmb_inner").slideToggle(50),e(this).addClass("closed"))}),!1}),e(".dmb_expand_rows").click(function(t){return e(".dmb_handle").each(function(t,i){e(this).hasClass("closed")&&(e(this).siblings(".dmb_inner").slideToggle(50),e(this).removeClass("closed"))}),!1}),e(".dmb_move_row_down").click(function(t){e(this).closest(".dmb_main").next().hasClass("dmb_main")&&(e(this).closest(".dmb_main").clone(!0).insertAfter(e(this).closest(".dmb_main").next()),e(this).closest(".dmb_main").remove());return!1}),e(".dmb_move_row_up").click(function(t){e(this).closest(".dmb_main").prev().hasClass("dmb_main")&&(e(this).closest(".dmb_main").clone(!0).insertBefore(e(this).closest(".dmb_main").prev()),e(this).closest(".dmb_main").remove());return!1}),e(".dmb_clone_row").click(function(t){var i=e(this).closest(".dmb_main").clone(!0);return i.insertAfter(e(this).closest(".dmb_main")),i.find(".dmb_handle_title").html(i.find(".dmb_firstname_of_member").val()+" ("+objectL10n.copy+")"),i.find(".dmb_firstname_of_member").focus(),o(i.find(".dmb_firstname_of_member"),!0),d(),!1}),e(".dmb_main").not(".dmb_empty_row").each(function(t,i){if(""!=e(this).find(".dmb_firstname_of_member").val()){var m=e(this).find(".dmb_handle_title"),n=e(this).find(".dmb_firstname_of_member").val(),_=e(this).find(".dmb_lastname_of_member").val();m.html(n+" "+_)}}),e("body").on("keyup",".dmb_firstname_of_member",function(t){o(e(this))}),e("body").on("keyup",".dmb_lastname_of_member",function(t){firstnameField=e(this).closest(".dmb_main").find(".dmb_firstname_of_member"),o(firstnameField)}),e(".dmb_show_preview_team").click(function(){var t,i={},m={},n="";i.columns=e("select[name='team_columns'] option:selected").val(),i.bio_alignment=e("select[name='team_bio_align'] option:selected").val(),i.piclink_beh=e("select[name='team_piclink_beh'] option:selected").val(),"new"==i.piclink_beh?m.plb='target="_blank"':m.plb="",i.color=((t=e(".dmb_color_of_team").find(".wp-color-result").css("backgroundColor"))?"#"+a((t=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))[1])+a(t[2])+a(t[3]):void 0)||"#8dba09",m.memberCount=e(".dmb_main").not(".dmb_empty_row").length,n+='<div class="tmm" style="margin-top: 100px;">',n+='<div class="tmm_'+i.columns+'_columns tmm_wrap tmm_plugin_f">',e(".dmb_main").not(".dmb_empty_row").each(function(t,_){var s={};s.firstname=e(this).find(".dmb_firstname_of_member").val(),s.lastname=e(this).find(".dmb_lastname_of_member").val(),s.job=e(this).find(".dmb_job_of_member").val(),e("#acf-fallback-bio").length?s.bio=e.trim(e(this).find(".dmb_description_of_member_fb").text())||"":s.bio=e.trim(e(this).find(".dmb_description_of_member").html())||"",s.scl_type1=e(this).find(".dmb_scl_type1_of_member").find(":selected").val(),s.scl_title1=e(this).find(".dmb_scl_title1_of_member").val(),s.scl_url1=e(this).find(".dmb_scl_url1_of_member").val(),s.scl_type2=e(this).find(".dmb_scl_type2_of_member").find(":selected").val(),s.scl_title2=e(this).find(".dmb_scl_title2_of_member").val(),s.scl_url2=e(this).find(".dmb_scl_url2_of_member").val(),s.scl_type3=e(this).find(".dmb_scl_type3_of_member").find(":selected").val(),s.scl_title3=e(this).find(".dmb_scl_title3_of_member").val(),s.scl_url3=e(this).find(".dmb_scl_url3_of_member").val(),s.photoUrl=e(this).find(".dmb_img").attr("src"),s.photoLinkUrl=e(this).find(".dmb_photo_url_of_member").val(),t%2==0&&(n+='<span class="tmm_two_containers_tablet"></span>'),t%i.columns==0&&(t>0&&(n+='</div><span class="tmm_columns_containers_desktop"></span>'),n+='<div class="tmm_container">'),n+='<div class="tmm_member" style="border-top:'+i.color+' solid 5px;">',s.photoLinkUrl&&(n+="<a "+i.piclink_beh+' href="'+s.photoLinkUrl+'" title="'+s.firstname+" "+s.lastname+'">'),s.photoUrl&&(n+='<div class="tmm_photo tmm_pic_'+t+'" style="background: url('+s.photoUrl+'); margin-left: auto; margin-right:auto; background-size:cover !important;"></div>'),s.photoLinkUrl&&(n+="</a>"),n+='<div class="tmm_textblock">',n+='<div class="tmm_names">',s.firstname&&(n+='<span class="tmm_fname">'+s.firstname+"</span> "),s.lastname&&(n+='<span class="tmm_lname">'+s.lastname+"</span>"),n+="</div>",s.job&&(n+='<div class="tmm_job">'+s.job+"</div>"),s.bio&&(n+='<div class="tmm_desc" style="text-align:'+i.bio_alignment+'">'+s.bio+"</div>"),n+='<div class="tmm_scblock">';for(var a=1;a<=3;a++)if("nada"!=s["scl_type"+a]){var l=s["scl_url"+a]?s["scl_url"+a]:"",d=s["scl_title"+t]?s["scl_title"+a]:"";"email"==s["scl_type"+a]?n+='<a class="tmm_sociallink" href="mailto:'+l+'" title="'+d+'"><img alt="'+d+'" src="../wp-content/plugins/team-members/inc/img/links/'+s["scl_type"+a]+'.png"/></a>':n+='<a target="_blank" class="tmm_sociallink" href="'+l+'" title="'+d+'"><img alt="'+d+'" src="../wp-content/plugins/team-members/inc/img/links/'+s["scl_type"+a]+'.png"/></a>'}n+="</div>",n+="</div>",n+="</div>",t==m.memberCount-1&&(n+='<div style="clear:both;"></div>')}),n+="</div>",n+="</div>",n+="</div>",n+='<div style="clear:both;"></div>',n+='<div class="dmb_accuracy_preview_notice">'+objectL10n.previewAccuracy+"</div>",0==m.memberCount?e("#dmb_preview_team").append('<div class="dmb_no_row_preview_notice">'+objectL10n.noMemberNotice+"</div>"):e("#dmb_preview_team").append(n),e("#dmb_preview_team").fadeIn(100)}),e(".dmb_preview_team_close").click(function(){e("#dmb_preview_team .tmm, .dmb_accuracy_preview_notice, .dmb_no_row_preview_notice").remove(),e("#dmb_preview_team").fadeOut(100)}),!e("#acf-fallback-bio").length){var r="";e(".dmb_edit_description_of_member").click(function(){var t=(r=e(this).parent().find(".dmb_description_of_member")).html();e("#wp-dmb_editor-wrap").hasClass("tmce-active")?tinymce.activeEditor.setContent(t):e("#dmb_editor").val(e.trim(t)),e("#dmb_unique_editor").fadeIn(100),null!==tinyMCE.activeEditor&&tinyMCE.activeEditor.focus()})}e("#acf-fallback-bio").length||e(".dmb_ue_update").click(function(){if(e("#wp-dmb_editor-wrap").hasClass("tmce-active"))var t=tinyMCE.activeEditor.getContent();else t=e("#dmb_editor").val();return t?r.show():r.hide(),r.html(e.parseHTML(t)),e("#dmb_unique_editor").fadeOut(100),null!==tinymce.activeEditor&&tinymce.activeEditor.setContent(""),l(r),!1}),e("#acf-fallback-bio").length||e(".dmb_ue_cancel").click(function(){e("#dmb_unique_editor").fadeOut(100)}),e("body").on("paste keyup","#acf-fallback-bio",(i=function(){e(this).siblings(".dmb_description_of_member_fb").text(e(this).val()),l(e(this))},m=600,function(){var e=this,t=arguments,s=n&&!_;clearTimeout(_),_=setTimeout(function(){_=null,n||i.apply(e,t)},m),s&&i.apply(e,t)}))})}(jQuery);